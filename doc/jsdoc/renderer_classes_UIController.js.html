

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: renderer/classes/UIController.js | Source: renderer/classes/UIController.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="">
        
            <img src="img/toast-ui.png" width="100%" height="100%">
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Source: renderer/classes/UIController.js</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="AnnotationPopup.html">AnnotationPopup</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="AnnotationPopup_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="AnnotationPopup.html#.toggleAnnotSubmitButton">toggleAnnotSubmitButton</a></li><li><a href="AnnotationPopup.html#_clearAll">_clearAll</a></li><li><a href="AnnotationPopup.html#_clearAnnotationForm">_clearAnnotationForm</a></li><li><a href="AnnotationPopup.html#_clearAnnotationView">_clearAnnotationView</a></li><li><a href="AnnotationPopup.html#_createAnnotationElement">_createAnnotationElement</a></li><li><a href="AnnotationPopup.html#_createAnnotationID">_createAnnotationID</a></li><li><a href="AnnotationPopup.html#_createCollapeButton">_createCollapeButton</a></li><li><a href="AnnotationPopup.html#_createDeleteButton">_createDeleteButton</a></li><li><a href="AnnotationPopup.html#_createEditButton">_createEditButton</a></li><li><a href="AnnotationPopup.html#_createHideButton">_createHideButton</a></li><li><a href="AnnotationPopup.html#_removeFromServer">_removeFromServer</a></li><li><a href="AnnotationPopup.html#_writeToServer">_writeToServer</a></li><li><a href="AnnotationPopup.html#addAnnotation">addAnnotation</a></li><li><a href="AnnotationPopup.html#deleteAnnotation">deleteAnnotation</a></li><li><a href="AnnotationPopup.html#editAnnotation">editAnnotation</a></li><li><a href="AnnotationPopup.html#hideAnnotation">hideAnnotation</a></li><li><a href="AnnotationPopup.html#loadAnnotations">loadAnnotations</a></li><li><a href="AnnotationPopup.html#toggleAnnotSubmitButton">toggleAnnotSubmitButton</a></li><li><a href="AnnotationPopup.html#updateAnnotation">updateAnnotation</a></li></ul></div></li><li><a href="CanvasManager.html">CanvasManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="CanvasManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="CanvasManager.html#addEditor">addEditor</a></li><li><a href="CanvasManager.html#addFragment">addFragment</a></li><li><a href="CanvasManager.html#clearAll">clearAll</a></li><li><a href="CanvasManager.html#clearFragments">clearFragments</a></li><li><a href="CanvasManager.html#createFragmentID">createFragmentID</a></li><li><a href="CanvasManager.html#doStep">doStep</a></li><li><a href="CanvasManager.html#getAll">getAll</a></li><li><a href="CanvasManager.html#getAnnots">getAnnots</a></li><li><a href="CanvasManager.html#getEditors">getEditors</a></li><li><a href="CanvasManager.html#getFragment">getFragment</a></li><li><a href="CanvasManager.html#getFragments">getFragments</a></li><li><a href="CanvasManager.html#getScreenshot">getScreenshot</a></li><li><a href="CanvasManager.html#getStage">getStage</a></li><li><a href="CanvasManager.html#loadFile">loadFile</a></li><li><a href="CanvasManager.html#redoStep">redoStep</a></li><li><a href="CanvasManager.html#removeAnnotation">removeAnnotation</a></li><li><a href="CanvasManager.html#removeFragment">removeFragment</a></li><li><a href="CanvasManager.html#setAnnotation">setAnnotation</a></li><li><a href="CanvasManager.html#setScreenshot">setScreenshot</a></li><li><a href="CanvasManager.html#undoStep">undoStep</a></li><li><a href="CanvasManager.html#updateAll">updateAll</a></li><li><a href="CanvasManager.html#updateEditor">updateEditor</a></li><li><a href="CanvasManager.html#updateFragment">updateFragment</a></li></ul></div></li><li><a href="Fragment.html">Fragment</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Fragment_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Fragment.html#_createContainer">_createContainer</a></li><li><a href="Fragment.html#_createImage">_createImage</a></li><li><a href="Fragment.html#_createMask">_createMask</a></li><li><a href="Fragment.html#flip">flip</a></li><li><a href="Fragment.html#getBaseX">getBaseX</a></li><li><a href="Fragment.html#getBaseY">getBaseY</a></li><li><a href="Fragment.html#getBounds">getBounds</a></li><li><a href="Fragment.html#getContainer">getContainer</a></li><li><a href="Fragment.html#getData">getData</a></li><li><a href="Fragment.html#getGlobalBounds">getGlobalBounds</a></li><li><a href="Fragment.html#getHiddenImage">getHiddenImage</a></li><li><a href="Fragment.html#getImage">getImage</a></li><li><a href="Fragment.html#getImageURL">getImageURL</a></li><li><a href="Fragment.html#getInnerContainer">getInnerContainer</a></li><li><a href="Fragment.html#getMask">getMask</a></li><li><a href="Fragment.html#getMask">getMask</a></li><li><a href="Fragment.html#getMaskBounds">getMaskBounds</a></li><li><a href="Fragment.html#getName">getName</a></li><li><a href="Fragment.html#getPosition">getPosition</a></li><li><a href="Fragment.html#getRotation">getRotation</a></li><li><a href="Fragment.html#getX">getX</a></li><li><a href="Fragment.html#getY">getY</a></li><li><a href="Fragment.html#ghost">ghost</a></li><li><a href="Fragment.html#moveByDistance">moveByDistance</a></li><li><a href="Fragment.html#moveToPixel">moveToPixel</a></li><li><a href="Fragment.html#rotateByAngle">rotateByAngle</a></li><li><a href="Fragment.html#rotateToAngle">rotateToAngle</a></li><li><a href="Fragment.html#scaleToValue">scaleToValue</a></li><li><a href="Fragment.html#translateRotation">translateRotation</a></li></ul></div></li><li><a href="ImageManager.html">ImageManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="ImageManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="ImageManager.html#selectImageFromFilesystem">selectImageFromFilesystem</a></li></ul></div></li><li><a href="Measurement.html">Measurement</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Measurement_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Measurement.html#color">color</a></li><li><a href="Measurement.html#id">id</a></li><li><a href="Measurement.html#measurement">measurement</a></li><li><a href="Measurement.html#p1">p1</a></li><li><a href="Measurement.html#p2">p2</a></li><li><a href="Measurement.html#stage">stage</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Measurement.html#clearPoints">clearPoints</a></li><li><a href="Measurement.html#drawMeasurement">drawMeasurement</a></li><li><a href="Measurement.html#getColor">getColor</a></li><li><a href="Measurement.html#getDistanceInCm">getDistanceInCm</a></li><li><a href="Measurement.html#getDistanceInPixel">getDistanceInPixel</a></li><li><a href="Measurement.html#getID">getID</a></li><li><a href="Measurement.html#getMeasurement">getMeasurement</a></li><li><a href="Measurement.html#getP1">getP1</a></li><li><a href="Measurement.html#getP2">getP2</a></li><li><a href="Measurement.html#setP1">setP1</a></li><li><a href="Measurement.html#setP2">setP2</a></li><li><a href="Measurement.html#setPoint">setPoint</a></li></ul></div></li><li><a href="SaveManager.html">SaveManager</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="SaveManager_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="SaveManager.html#clear">clear</a></li><li><a href="SaveManager.html#deleteFile">deleteFile</a></li><li><a href="SaveManager.html#getCurrentFilepath">getCurrentFilepath</a></li><li><a href="SaveManager.html#getCurrentFolder">getCurrentFolder</a></li><li><a href="SaveManager.html#getDefaultFolder">getDefaultFolder</a></li><li><a href="SaveManager.html#getSaveFiles">getSaveFiles</a></li><li><a href="SaveManager.html#getSaveFolder">getSaveFolder</a></li><li><a href="SaveManager.html#loadSaveFile">loadSaveFile</a></li><li><a href="SaveManager.html#loadTable">loadTable</a></li><li><a href="SaveManager.html#saveSavefile">saveSavefile</a></li><li><a href="SaveManager.html#saveTable">saveTable</a></li></ul></div></li><li><a href="Scaler.html">Scaler</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Scaler_sub"></div></li><li><a href="Selector.html">Selector</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Selector_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Selector.html#getBb">getBb</a></li><li><a href="Selector.html#setToDefault">setToDefault</a></li><li><a href="Selector.html#updateBb">updateBb</a></li></ul></div></li><li><a href="Sidebar.html">Sidebar</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Sidebar_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Sidebar.html#_addFragment">_addFragment</a></li><li><a href="Sidebar.html#addFragmentListButtons">addFragmentListButtons</a></li><li><a href="Sidebar.html#addMeasurement">addMeasurement</a></li><li><a href="Sidebar.html#clearMeasurements">clearMeasurements</a></li><li><a href="Sidebar.html#clearSelection">clearSelection</a></li><li><a href="Sidebar.html#deleteMeasurement">deleteMeasurement</a></li><li><a href="Sidebar.html#deselectFragment">deselectFragment</a></li><li><a href="Sidebar.html#highlightFragment">highlightFragment</a></li><li><a href="Sidebar.html#removeFragmentListButtons">removeFragmentListButtons</a></li><li><a href="Sidebar.html#selectFragment">selectFragment</a></li><li><a href="Sidebar.html#unhighlightFragment">unhighlightFragment</a></li><li><a href="Sidebar.html#updateDoButtons">updateDoButtons</a></li><li><a href="Sidebar.html#updateFragmentList">updateFragmentList</a></li><li><a href="Sidebar.html#updateMeasurements">updateMeasurements</a></li></ul></div></li><li><a href="Stage.html">Stage</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Stage_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Stage.html#activeMeasurement">activeMeasurement</a></li><li><a href="Stage.html#background">background</a></li><li><a href="Stage.html#controller">controller</a></li><li><a href="Stage.html#fragmentLabel">fragmentLabel</a></li><li><a href="Stage.html#fragmentList">fragmentList</a></li><li><a href="Stage.html#grid">grid</a></li><li><a href="Stage.html#gridMode">gridMode</a></li><li><a href="Stage.html#lines">lines</a></li><li><a href="Stage.html#loadqueue">loadqueue</a></li><li><a href="Stage.html#mColor">mColor</a></li><li><a href="Stage.html#measurements">measurements</a></li><li><a href="Stage.html#measurementsContainer">measurementsContainer</a></li><li><a href="Stage.html#measureMode">measureMode</a></li><li><a href="Stage.html#scale">scale</a></li><li><a href="Stage.html#scaleMode">scaleMode</a></li><li><a href="Stage.html#selectedList">selectedList</a></li><li><a href="Stage.html#selector">selector</a></li><li><a href="Stage.html#stage">stage</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Stage.html#clearMeasurements">clearMeasurements</a></li><li><a href="Stage.html#clearSelection">clearSelection</a></li><li><a href="Stage.html#deleteMeasurement">deleteMeasurement</a></li><li><a href="Stage.html#deleteSelectedFragments">deleteSelectedFragments</a></li><li><a href="Stage.html#deselectFragment">deselectFragment</a></li><li><a href="Stage.html#endMeasurement">endMeasurement</a></li><li><a href="Stage.html#exportCanvas">exportCanvas</a></li><li><a href="Stage.html#fitToScreen">fitToScreen</a></li><li><a href="Stage.html#flipTable">flipTable</a></li><li><a href="Stage.html#getCenter">getCenter</a></li><li><a href="Stage.html#getData">getData</a></li><li><a href="Stage.html#getFragment">getFragment</a></li><li><a href="Stage.html#getFragmentList">getFragmentList</a></li><li><a href="Stage.html#getFragmentsData">getFragmentsData</a></li><li><a href="Stage.html#getMBR">getMBR</a></li><li><a href="Stage.html#getMeasureColor">getMeasureColor</a></li><li><a href="Stage.html#getNewFragmentId">getNewFragmentId</a></li><li><a href="Stage.html#getNewMeasurementID">getNewMeasurementID</a></li><li><a href="Stage.html#getRandomColor">getRandomColor</a></li><li><a href="Stage.html#getScaling">getScaling</a></li><li><a href="Stage.html#getSelectedList">getSelectedList</a></li><li><a href="Stage.html#getStageData">getStageData</a></li><li><a href="Stage.html#hasMeasureMode">hasMeasureMode</a></li><li><a href="Stage.html#hideFlipLines">hideFlipLines</a></li><li><a href="Stage.html#highlightFragment">highlightFragment</a></li><li><a href="Stage.html#loadScene">loadScene</a></li><li><a href="Stage.html#measure">measure</a></li><li><a href="Stage.html#moveStage">moveStage</a></li><li><a href="Stage.html#registerImageEvents">registerImageEvents</a></li><li><a href="Stage.html#removeFragment">removeFragment</a></li><li><a href="Stage.html#resizeCanvas">resizeCanvas</a></li><li><a href="Stage.html#selectFragment">selectFragment</a></li><li><a href="Stage.html#setScaling">setScaling</a></li><li><a href="Stage.html#showFlipLine">showFlipLine</a></li><li><a href="Stage.html#startMeasurement">startMeasurement</a></li><li><a href="Stage.html#toggleGridMode">toggleGridMode</a></li><li><a href="Stage.html#toggleScaleMode">toggleScaleMode</a></li><li><a href="Stage.html#unhighlightFragment">unhighlightFragment</a></li><li><a href="Stage.html#update">update</a></li><li><a href="Stage.html#updateGrid">updateGrid</a></li><li><a href="Stage.html#updateMeasurements">updateMeasurements</a></li><li><a href="Stage.html#updateScale">updateScale</a></li></ul></div></li><li><a href="UIController.html">UIController</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="UIController_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="UIController.html#annotationPopup">annotationPopup</a></li><li><a href="UIController.html#darkBackground">darkBackground</a></li><li><a href="UIController.html#hasUnsaved">hasUnsaved</a></li><li><a href="UIController.html#hotkeysOn">hotkeysOn</a></li><li><a href="UIController.html#initiallySaved">initiallySaved</a></li><li><a href="UIController.html#lightMode">lightMode</a></li><li><a href="UIController.html#sidebar">sidebar</a></li><li><a href="UIController.html#stage">stage</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="UIController.html#addFragment">addFragment</a></li><li><a href="UIController.html#addMeasurement">addMeasurement</a></li><li><a href="UIController.html#centerToFragment">centerToFragment</a></li><li><a href="UIController.html#changeFragment">changeFragment</a></li><li><a href="UIController.html#clearMeasurements">clearMeasurements</a></li><li><a href="UIController.html#clearSelection">clearSelection</a></li><li><a href="UIController.html#clearTable">clearTable</a></li><li><a href="UIController.html#confirmClearTable">confirmClearTable</a></li><li><a href="UIController.html#deleteAnnotation">deleteAnnotation</a></li><li><a href="UIController.html#deleteMeasurement">deleteMeasurement</a></li><li><a href="UIController.html#deselectFragment">deselectFragment</a></li><li><a href="UIController.html#disableHotkeys">disableHotkeys</a></li><li><a href="UIController.html#enableHotkeys">enableHotkeys</a></li><li><a href="UIController.html#endMeasurement">endMeasurement</a></li><li><a href="UIController.html#exportCanvas">exportCanvas</a></li><li><a href="UIController.html#fitToScreen">fitToScreen</a></li><li><a href="UIController.html#flipTable">flipTable</a></li><li><a href="UIController.html#getCanvasCenter">getCanvasCenter</a></li><li><a href="UIController.html#getHotkeysOn">getHotkeysOn</a></li><li><a href="UIController.html#getScaling">getScaling</a></li><li><a href="UIController.html#getSidebar">getSidebar</a></li><li><a href="UIController.html#getStage">getStage</a></li><li><a href="UIController.html#hideFlipLines">hideFlipLines</a></li><li><a href="UIController.html#highlightFragment">highlightFragment</a></li><li><a href="UIController.html#isDevMode">isDevMode</a></li><li><a href="UIController.html#loadScene">loadScene</a></li><li><a href="UIController.html#loadTable">loadTable</a></li><li><a href="UIController.html#previewBackground">previewBackground</a></li><li><a href="UIController.html#quitTable">quitTable</a></li><li><a href="UIController.html#redoMeasurement">redoMeasurement</a></li><li><a href="UIController.html#removeFragment">removeFragment</a></li><li><a href="UIController.html#removeFragments">removeFragments</a></li><li><a href="UIController.html#resetZoom">resetZoom</a></li><li><a href="UIController.html#resizeCanvas">resizeCanvas</a></li><li><a href="UIController.html#save">save</a></li><li><a href="UIController.html#saveToModel">saveToModel</a></li><li><a href="UIController.html#selectFragment">selectFragment</a></li><li><a href="UIController.html#sendAnnotation">sendAnnotation</a></li><li><a href="UIController.html#sendToServer">sendToServer</a></li><li><a href="UIController.html#setScaling">setScaling</a></li><li><a href="UIController.html#showFlipLine">showFlipLine</a></li><li><a href="UIController.html#showVisualFeedback">showVisualFeedback</a></li><li><a href="UIController.html#toggleAnnotSubmitButton">toggleAnnotSubmitButton</a></li><li><a href="UIController.html#toggleDevMode">toggleDevMode</a></li><li><a href="UIController.html#toggleGridMode">toggleGridMode</a></li><li><a href="UIController.html#toggleLight">toggleLight</a></li><li><a href="UIController.html#toggleScaleMode">toggleScaleMode</a></li><li><a href="UIController.html#unhighlightFragment">unhighlightFragment</a></li><li><a href="UIController.html#update">update</a></li><li><a href="UIController.html#updateAnnotation">updateAnnotation</a></li><li><a href="UIController.html#updateMeasurements">updateMeasurements</a></li><li><a href="UIController.html#updateSidebarFragmentList">updateSidebarFragmentList</a></li></ul></div></li><li><a href="Util.html">Util</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Util_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Util.html#.convertTime">convertTime</a></li></ul></div></li><li><a href="Window.html">Window</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Window_sub"></div></li></ul></div><div class="lnb-api hidden"><h3>Global</h3><ul><li><a href="global.html#activateCanvas">activateCanvas</a></li><li><a href="global.html#activateKonami">activateKonami</a></li><li><a href="global.html#addPolygonNode">addPolygonNode</a></li><li><a href="global.html#addScalePoint">addScalePoint</a></li><li><a href="global.html#adjustSizes">adjustSizes</a></li><li><a href="global.html#checkForKonami">checkForKonami</a></li><li><a href="global.html#checkIfReady">checkIfReady</a></li><li><a href="global.html#clearCanvas">clearCanvas</a></li><li><a href="global.html#clearPolygon">clearPolygon</a></li><li><a href="global.html#clearSearch">clearSearch</a></li><li><a href="global.html#convertTime">convertTime</a></li><li><a href="global.html#cropSize">cropSize</a></li><li><a href="global.html#deactivateCanvas">deactivateCanvas</a></li><li><a href="global.html#deleteSavefile">deleteSavefile</a></li><li><a href="global.html#draw">draw</a></li><li><a href="global.html#drawCanvas">drawCanvas</a></li><li><a href="global.html#drawCropBox">drawCropBox</a></li><li><a href="global.html#drawMasks">drawMasks</a></li><li><a href="global.html#drawPolygon">drawPolygon</a></li><li><a href="global.html#drawScale">drawScale</a></li><li><a href="global.html#getFittingScale">getFittingScale</a></li><li><a href="global.html#handleScaleButton">handleScaleButton</a></li><li><a href="global.html#mirrorPolygon">mirrorPolygon</a></li><li><a href="global.html#moveImage">moveImage</a></li><li><a href="global.html#readExifPPI">readExifPPI</a></li><li><a href="global.html#resetCropbox">resetCropbox</a></li><li><a href="global.html#rotate90Degree">rotate90Degree</a></li><li><a href="global.html#rotateImage">rotateImage</a></li><li><a href="global.html#selectDefaultFolder">selectDefaultFolder</a></li><li><a href="global.html#toggleSidebar">toggleSidebar</a></li><li><a href="global.html#updateModeButtons">updateModeButtons</a></li><li><a href="global.html#updateSaveList">updateSaveList</a></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

const {Sidebar} = require('./Sidebar');
const {Stage} = require('./Stage');
const {AnnotationPopup} = require('./AnnotationPopup');
const {ipcRenderer} = require('electron');
const Dialogs = require('dialogs');
const dialogs = new Dialogs();

/**
 *  The UI Controller is the controller instance for the whole view; it controls all individual
 *  view elements, e.g. the canvas stage or the sidebar, such that changes can be updated in all places
 *  accordingly. Mainly used for communicaton with the server process and for distribution of
 *  signals which are relevant for multiple view elements.
 */
class UIController {
  /**
   * When a new UIController instance is created, it automatically produces further control elements for various
   * UI sections, like the sidebar, the annotations window or the stage itself. This helps to keep methods to
   * the regions where they are actually needed.
   * @constructs
   * @param {String} DOMElement - ID reference of the HTML canvas object that will hold the stage representation.
   */
  constructor(DOMElement) {
    /** @constant {Stage} */
    this.stage = new Stage(this, DOMElement);
    /** @constant {Sidebar} */
    this.sidebar = new Sidebar(this);
    /** @constant {AnnotationPopup} */
    this.annotationPopup = new AnnotationPopup(this);
    /** @member {Boolean} */
    this.hotkeysOn = true;
    /** @member {Boolean} */
    this.hasUnsaved = false;
    /** @member {Boolean} */
    this.initiallySaved = false;
    /** @member {'dark' | 'bright'} */
    this.lightMode = 'dark';
    /** @member {String} */
    this.darkBackground;

    this.devMode = false;
  }

  /**
   * Communication method for sending messages back to the server.
   * @param {String} message - Control sequence according to
   *                      the server/client protocol.
   * @param {Object} [data] - Object containing the information needed
   *                   by the server to proceed with the given action.
   */
  sendToServer(message, data) {
    if (data) {
      if (this.devMode) console.log('Sending ' + message + '; data:', data);
      ipcRenderer.send(message, data);
    } else {
      if (this.devMode) console.log('Sending ' + message + '; no data.');
      ipcRenderer.send(message);
    }
  }

  /**
   * TODO
   * @param {Boolean} isQuicksave
   *    if TRUE, the VLT will try to overwrite the pre-existing file
   *    if FALSE, the VLT will automatically ask for a new savefile
   */
  save(isQuicksave) {
    const data = {};
    data.screenshot = this.exportCanvas('png', true, true);
    data.quicksave = isQuicksave;

    if (isQuicksave &amp;&amp; this.initiallySaved) {
      // not first quicksave, thus editor no longer needed
      this.sendToServer('server-save-file', data);
      this.hasUnsaved = false;
    } else {
      this.disableHotkeys();
      dialogs.prompt('Please enter your name(s)/initials:', (editor) => {
        if (editor != '' &amp;&amp; editor != null) {
          data.editor = editor;
          this.sendToServer('server-save-file', data);
          this.hasUnsaved = false;
          this.initiallySaved = true;
        }
        this.enableHotkeys();
      });
    }
  }

  /**
   * Triggers load table procedure by sending request
   * to the server. Only proceeds if there have been no changes or user confirms.
   */
  loadTable() {
    if (!this.hasUnsaved) {
      this.sendToServer('server-open-load');
    } else if (this.confirmClearTable()) {
      this.sendToServer('server-open-load');
    }
  }

  /**
   * Gathers table configuration from stage and sends save request to server.
   * @param {Object} data - Object containing all information about the stage
   *                   configuration and the fragments to be saved to the model.
   */
  saveToModel(data) {
    this.hasUnsaved = true;
    this.sendToServer('server-save-to-model', data);
  }

  /**
   * Relay function. Resets a potentially active measurement process and requests empty table
   * from server. Only works if there are no currently unsaved changes or if user confirms.
   */
  clearTable() {
    if (!this.hasUnsaved) {
      this.clearMeasurements();
      this.sendToServer('server-clear-table');
      this.hasUnsaved = false;
      this.initiallySaved = false;
    } else if (this.confirmClearTable()) {
      this.clearMeasurements();
      this.sendToServer('server-clear-table');
      this.hasUnsaved = false;
      this.initiallySaved = false;
    }
  }

  /**
   * Input function. Asks user for confirmation that unsaved changes can be
   * overwritten.
   * @return {Boolean} True if changes can be overwritten, false otherwise.
   */
  confirmClearTable() {
    const confirmation = confirm('You still have unsaved changes '+
    'on your table. Are you sure you want to proceed?');
    return confirmation;
  }


  /**
   * TODO
   * @param {String} [id] - ID of annotation, e.g. "a_0".
   */
  sendAnnotation(id) {
    console.log('annotation id', id);
    if (id) {
      this.annotationPopup.updateAnnotation(id);
    } else {
      this.annotationPopup.addAnnotation();
    }
  }

  /**
   * TODO
   * @param {*} annotationElement
   */
  deleteAnnotation(annotationElement) {

  }

  /**
   * TODO
   * @param {*} annotationElement
   */
  updateAnnotation(annotationElement) {

  }

  /**
   * TODO
   */
  toggleAnnotSubmitButton() {
    this.annotationPopup.toggleAnnotSubmitButton();
  }

  /**
   * Notifies GUI elements that the fragment with a given ID needs to be displayed as selected.
   * @param {String} fragmentId - Fragment identifer, e.g. "f_0".
   */
  selectFragment(fragmentId) {
    this.stage.selectFragment(fragmentId);
    this.sidebar.selectFragment(fragmentId);
  }

  /**
   * Notifies GUI elements to deselect the fragment with given ID.
   * @param {String} fragmentId - Fragment identifier, e.g. "f_0".
   */
  deselectFragment(fragmentId) {
    this.stage.deselectFragment(fragmentId);
    this.sidebar.deselectFragment(fragmentId);
  }

  /**
   * Notifies GUI elements to deselect all fragments.
   */
  clearSelection() {
    this.stage.clearSelection();
    this.sidebar.clearSelection();
  }

  /**
   * Notifies GUI elements that a fragment with given ID is currently to be displayed as
   * being highlighted.
   * @param {String} fragmentId - Fragment identifier, e.g. "f_0".
   */
  highlightFragment(fragmentId) {
    this.stage.highlightFragment(fragmentId);
    this.sidebar.highlightFragment(fragmentId);
  }

  /**
   * Notifies GUI elements to remove the highlighting from a fragment with given ID.
   * @param {String} fragmentId - Fragment identifier, e.g. "f_0".
   */
  unhighlightFragment(fragmentId) {
    this.stage.unhighlightFragment(fragmentId);
    this.sidebar.unhighlightFragment(fragmentId);
  }

  /**
   * Gathers the current list of fragments on the table (fragmentList) and the list of
   * actively selected fragments (selectedList) from the stage and updates the sidebar accordingly.
   */
  updateSidebarFragmentList() {
    const fragmentList = this.stage.getFragmentList();
    const selectedList = this.stage.getSelectedList();
    this.sidebar.updateFragmentList(fragmentList, selectedList);
  }

  /**
   * Asks the user for confirmation that the selected fragments shall be deleted. If so, the
   * selected items are removed from the table and sidebar is updated. Does NOT notify the server about removal, this
   * is initialised by the stage object itself after removal.
   */
  removeFragments() {
    if (Object.keys(this.stage.getSelectedList()).length > 0) {
      const confirmation = confirm('Do you really want to remove this ' +
          'fragment/these fragments from the light table? (the original ' +
          'files will not be deleted)');

      if (confirmation) {
        this.stage.deleteSelectedFragments();
        this.updateSidebarFragmentList();
      }
    }
  }

  /**
   * Asks the user for confirmation to remove a specific fragment with given ID
   * from the table. If so, the task is relayed to the stage.
   * @param {String} id - Fragment identifier, e.g. "f_0".
   */
  removeFragment(id) {
    const confirmation = confirm('Do you really want to remove this fragment' +
            'from the light table? (the original files will not be deleted)');

    if (confirmation) {
      this.stage.removeFragment(id);
      this.updateSidebarFragmentList();
    }
  }

  /**
   * TODO
   * @param {*} fragmentData
   */
  addFragment(fragmentData) {
    this.stage._loadFragments({'upload': fragmentData});
    this.updateSidebarFragmentList();
    $('.arrow.down').removeClass('down');
    $('.expanded').removeClass('expanded');
    // second, rotate arrow down and expand clicked segment
    $('#fragment_list').find('.arrow').addClass('down');
    $('#fragment_list').addClass('expanded');
  }

  /**
   * Toggles the grid mode on the stage object to show or hide the background grid. The method call returns
   * the new status of the gridMode. Notifies the sidebar to toggle GUI elements accordingly.
   */
  toggleGridMode() {
    const gridMode = this.stage.toggleGridMode();
    // TODO Move to sidebar
    if (gridMode) {
      $('#grid_box').prop('checked', true);
    } else {
      $('#grid_box').prop('checked', false);
    }
  }

  /**
   * Toggles the scale mode on the stage object to show or hide the scale. The method call returns
   * the new status of the scaleMode. Notifies the sidebar to toggle GUI elements accordingly.
   */
  toggleScaleMode() {
    const scaleMode = this.stage.toggleScaleMode();
    if (scaleMode) {
      $('#scale_box').prop('checked', true);
    } else {
      $('#scale_box').prop('checked', false);
    }
  }

  /**
   * @private
   * Toggles the fibre mode on the stage object to show or hide the fibre orientation. The method call returns
   * the new status of the fibreMode. Notifies the sidebar to toggle GUI elements accordingly.
   * Not yet implemented.
   */
  toggleFibreMode() {
    // TODO Not yet implemented
  }

  /**
   * TODO
   * @return {*}
   */
  getCanvasCenter() {
    return this.stage.getCenter();
  }

  /**
   * Updates the whole table with a new scaling value, i.e.
   * both the stage itself (with the fragments to rescale and move) and
   * the zoom slider which should always show the acurate scaling factor.
   * Only allows for a scaling between (const scaleMin) and (const scaleMax).
   *
   * @param {double} scalingValue Value for new scaling ratio; this value
   * is the ratio * 100, e.g. not 1.0 but 100.
   * @param {double} scaleX - x position of scaling center if not window center.
   * @param {double} scaleY - y position of scaling center if not window center.
   */
  setScaling(scalingValue, scaleX, scaleY) {
    const scaleMin = 10;
    const scaleMax = 300;

    if (scalingValue &lt; scaleMin) {
      scalingValue = scaleMin;
    } else if (scalingValue > scaleMax) {
      scalingValue = scaleMax;
    }

    this.stage.setScaling(scalingValue, scaleX, scaleY);
    $('#zoom_slider').val(scalingValue);
    $('#zoom_factor').text('x'+Math.round((scalingValue/100)*100)/100);
  }

  /**
   * TODO
   * @return {*}
   */
  getScaling() {
    return this.stage.getScaling();
  }

  /**
   * Relays resizing request to the stage object.
   * @param {double} width - New width value for canvas.
   * @param {double} height - New height value for canvas.
   */
  resizeCanvas(width, height) {
    this.stage.resizeCanvas(width, height);
  }

  /**
   * TODO: reroute new stage/fragment data to stage, then update sidebar
   * @param {*} data
   */
  loadScene(data) {
    this.annotationPopup.loadAnnotations(data.annots);
    this.sidebar.updateDoButtons(data);
    this.stage.loadScene(data);
    this.updateSidebarFragmentList();
  }

  /**
   * Requests stage to perform a transformation such that the fragment with given id is centered in
   * the viewport.
   * @param {String} id - Fragment identifier, e.g. "f_0".
   */
  centerToFragment(id) {
    const stageC = this.stage.getCenter();
    const fragmentC = this.stage.getFragmentList()[id].getPosition();

    const deltaX = stageC.x - fragmentC.x;
    const deltaY = stageC.y - fragmentC.y;

    this.stage.moveStage(deltaX, deltaY);
  }

  /**
   * Triggers the display of a colored popup overlay to inform the user about something.
   * @param {String} titleText - Text to be displayed as title of the feedback box.
   * @param {String} descText - Text to be displayed as description
   * of the feedback box.
   * @param {String} [color] - Color of the feedback box. If no color is given, the
   * box will be rendered in white.
   * @param {Int} [duration] - Display duration of the message in milliseconds. If no duration
   * is given, the duration is adjusted to the total length of the message, with a minimum of 2000ms.
   */
  showVisualFeedback(titleText, descText, color, duration) {
    if (!color) {
      color = 'white';
    }
    if (!duration) {
      duration = (titleText.length + descText.length) * 40;
      duration = Math.max(duration, 1500);
    }
    $('#vf_title').empty().text(titleText);
    $('#vf_desc').empty().text(descText);
    $('#visual_feedback').css('background-color', color);
    $('#visual_feedback').css('display', 'block');
    $('#visual_feedback').css('left', '50%');
    $('#visual_feedback').css('left', '-=30px');

    $('#visual_feedback').stop().animate({
      opacity: '1.0',
      left: '+=15px',
    }, 700, function() {
      $('#visual_feedback')
          .delay(duration)
          .animate({
            opacity: '0.0',
            left: '+=15px',
          }, 700, function() {
            $('#visual_feedback')
                .css('display', 'none')
                .css('left', '50%');
          });
    });
  }

  /**
   * Comfort function to make the reset to a scale of 100 easier.
   */
  resetZoom() {
    this.setScaling(100);
  }

  /**
   * Relays the request for a table screenshot to the stage object.
   * @param {'jpg'|'png'|'tiff'} fileFormat - String indicating the extension of the desired screenshot format.
   * @param {Boolean} full - If true, the whole table configuration will be scaled to fit the screen before taking the
   * screenshot. If false, only the currently visible area will be screenshotted.
   * @param {Boolean} thumb - If true, the screenshot result will not be downloadable but be returned as return value.
   * @return {null | ImageFile} If thumb == true, then the return value will be the resulting image file. If thumb == false, the return
   * value will be null.
   */
  exportCanvas(fileFormat, full, thumb) {
    return this.stage.exportCanvas(fileFormat, full, thumb);
  }

  // Getter Methods

  /**
   * Returns the currently active Stage object.
   * @return {Stage}
   */
  getStage() {
    return this.stage;
  }

  /**
   * Returns the currently active Sidebar object.
   * @return {Sidebar}
   */
  getSidebar() {
    return this.sidebar;
  }

  /**
   * TODO
   */
  addMeasurement() {
    // only add new measurement if not already in measure mode
    if (!this.stage.hasMeasureMode()) {
      // STAGE
      const newId = this.stage.getNewMeasurementID();
      this.stage.startMeasurement(newId);
      // SIDEBAR
      const color = this.stage.getMeasureColor(newId);
      this.sidebar.addMeasurement(newId, color);
    }
  }

  /**
   * TODO
   */
  endMeasurement() {
    const id = this.stage.endMeasurement();
    this.sidebar.deleteMeasurement(id);
  }

  /**
   * TODO
   * @param {*} id
   */
  deleteMeasurement(id) {
    // STAGE
    this.stage.deleteMeasurement(id);
    // SIDEBAR
    this.sidebar.deleteMeasurement(id);
  }

  /**
   * TODO
   */
  clearMeasurements() {
    this.stage.clearMeasurements();
    // SIDEBAR
    this.sidebar.clearMeasurements();
  }

  /**
   * TODO
   * @param {int} id
   */
  redoMeasurement(id) {
    // STAGE
    this.stage.startMeasurement(id);
    // SIDEBAR
  }

  /**
   * TODO
   * @param {*} measurements
   */
  updateMeasurements(measurements) {
    this.sidebar.updateMeasurements(measurements);
  }

  /**
   * Functionality of certain hotkeys is provided. (note: "certain"
   * means that there are hotkeys which cannot break the overall functioning
   * of the application in any state; they will still work)
   */
  enableHotkeys() {
    this.hotkeysOn = true;
  }

  /**
   * Sets a flag that disables specific hotkeys that might interfere with the input of custom text.
   */
  disableHotkeys() {
    this.hotkeysOn = false;
  }

  /**
   * Returns the current state of hotkey activation.
   * @return {Boolean} True: all hotkeys are available; false: hotkeys that might interfere with custom text input are disabled.
   */
  getHotkeysOn() {
    return this.hotkeysOn;
  }

  /**
   * Triggers the update function of the Stage object and thus a complete redraw of the canvas.
   */
  update() {
    this.stage.update();
  }

  /**
   * Requests the Stage object to flip all fragments on stage according to the horizontal or vertical mirror axis.
   * @param {Boolean} horizontal - if true, all fragments are flipped along the horizontal mirror axis. If false, all fragments
   * are flipped along the vertical mirror axis.
   */
  flipTable(horizontal) {
    this.stage.flipTable(horizontal);
  }

  /**
   * Requests the Stage object to display the mirror axis for a specific table flip action.
   * @param {Boolean} horizontal - if true, horizontal mirror axis is shown. If false, vertical mirror axis is shown.
   */
  showFlipLine(horizontal) {
    this.stage.showFlipLine(horizontal);
  }

  /**
   * Requests the Stage object to hide all mirror axes.
   */
  hideFlipLines() {
    this.stage.hideFlipLines();
  }

  /**
   * Requests the Stage object to transform the scene such that all fragments are visible in the viewport.
   */
  fitToScreen() {
    this.stage.fitToScreen();
  }

  /**
   * Checks the flag for the whole client whether dev mode is activated
   * or not
   * @return {Boolean} If True, dev_mode is activated and development related functions and outputs
   * should be activated. If false, dev_mode is deactivated and these outputs should be hidden.
   */
  isDevMode() {
    return this.devMode;
  }

  /**
   * Toggles dev_mode flag.
   */
  toggleDevMode() {
    this.devMode = !this.devMode;
    if (this.devMode) console.log('Dev_Mode activated. Deactivate with [CTRL+ALT+D].');
    else console.log('Dev_Mode deactivated.');
  }

  /**
   * Triggers when the user wants to change the upload settings for a particular fragment, e.g. replacing one or both images with
   * other versions, changing the masks or the ppi information. This only works if exactly one fragment is selected (because otherwise
   * it is unclear which fragment to change). The request together with the necessary fragment data will be sent to the server.
   */
  changeFragment() {
    const selectionList = this.stage.getSelectedList();
    if (Object.keys(selectionList).length == 1) {
      const id = Object.keys(selectionList)[0];
      this.sendToServer('server-change-fragment', id);
    }
  }

  /**
   * TODO
   */
  quitTable() {
    if (!this.hasUnsaved) {
      this.sendToServer('server-quit-table');
    } else if (this.confirmClearTable()) {
      this.sendToServer('server-quit-table');
    }
  }

  /**
   * TODO
   */
  toggleLight() {
    if (this.lightMode == 'dark') {
      // current light_mode is "dark" => change to "bright"
      if (!this.darkBackground) this.darkBackground = $('body').css('background');
      $('body').css({backgroundColor: 'white'});
      $('#light_switch').addClass('button_active');
      $('#light_box').prop('checked', true);
      $('#zoom_slider').css('background-color', 'grey');
      this.lightMode = 'bright';
    } else {
      // current light_mode is "bright" => change to "dark"
      $('body').css({background: this.darkBackground});
      $('#light_switch').removeClass('button_active');
      $('#light_box').prop('checked', false);
      $('#zoom_slider').css('background-color', 'white');
      this.lightMode = 'dark';
    }
  }

  /**
   * TODO
   * @param {String} color
   * @param {Boolean} turnOn
   */
  previewBackground(color, turnOn) {
    if (!this.darkBackground &amp;&amp; this.lightMode == 'dark') {
      this.darkBackground = $('body').css('background');
    }
    if (turnOn) {
      $('body').css({backgroundColor: color});
    } else {
      if (this.lightMode == 'dark') {
        $('body').css({background: this.darkBackground});
      } else {
        $('body').css({backgroundColor: 'white'});
      }
    }
  }
}

module.exports.UIController = UIController;
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="img/toast-ui.png" style="">
    <div class="footer-text">NHN Entertainment. Frontend Development Lab</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
