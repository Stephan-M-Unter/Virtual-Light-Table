

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: load.js | Source: load.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="">
        
            <img src="img/toast-ui.png" width="100%" height="100%">
        
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Source: load.js</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
    <div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="AnnotationPopup.html">AnnotationPopup</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="AnnotationPopup_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="AnnotationPopup.html#.toggleAnnotSubmitButton">toggleAnnotSubmitButton</a></li><li><a href="AnnotationPopup.html#_clearAll">_clearAll</a></li><li><a href="AnnotationPopup.html#_clearAnnotationForm">_clearAnnotationForm</a></li><li><a href="AnnotationPopup.html#_clearAnnotationView">_clearAnnotationView</a></li><li><a href="AnnotationPopup.html#_createAnnotationElement">_createAnnotationElement</a></li><li><a href="AnnotationPopup.html#_createAnnotationID">_createAnnotationID</a></li><li><a href="AnnotationPopup.html#_createCollapeButton">_createCollapeButton</a></li><li><a href="AnnotationPopup.html#_createDeleteButton">_createDeleteButton</a></li><li><a href="AnnotationPopup.html#_createEditButton">_createEditButton</a></li><li><a href="AnnotationPopup.html#_createHideButton">_createHideButton</a></li><li><a href="AnnotationPopup.html#_removeFromServer">_removeFromServer</a></li><li><a href="AnnotationPopup.html#_writeToServer">_writeToServer</a></li><li><a href="AnnotationPopup.html#addAnnotation">addAnnotation</a></li><li><a href="AnnotationPopup.html#deleteAnnotation">deleteAnnotation</a></li><li><a href="AnnotationPopup.html#editAnnotation">editAnnotation</a></li><li><a href="AnnotationPopup.html#hideAnnotation">hideAnnotation</a></li><li><a href="AnnotationPopup.html#loadAnnotations">loadAnnotations</a></li><li><a href="AnnotationPopup.html#toggleAnnotSubmitButton">toggleAnnotSubmitButton</a></li><li><a href="AnnotationPopup.html#updateAnnotation">updateAnnotation</a></li></ul></div></li><li><a href="Fragment.html">Fragment</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Fragment_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Fragment.html#_createContainer">_createContainer</a></li><li><a href="Fragment.html#_createImage">_createImage</a></li><li><a href="Fragment.html#_createMask">_createMask</a></li><li><a href="Fragment.html#flip">flip</a></li><li><a href="Fragment.html#getBaseX">getBaseX</a></li><li><a href="Fragment.html#getBaseY">getBaseY</a></li><li><a href="Fragment.html#getBounds">getBounds</a></li><li><a href="Fragment.html#getContainer">getContainer</a></li><li><a href="Fragment.html#getData">getData</a></li><li><a href="Fragment.html#getGlobalBounds">getGlobalBounds</a></li><li><a href="Fragment.html#getHiddenImage">getHiddenImage</a></li><li><a href="Fragment.html#getImage">getImage</a></li><li><a href="Fragment.html#getImageURL">getImageURL</a></li><li><a href="Fragment.html#getInnerContainer">getInnerContainer</a></li><li><a href="Fragment.html#getMask">getMask</a></li><li><a href="Fragment.html#getMask">getMask</a></li><li><a href="Fragment.html#getMaskBounds">getMaskBounds</a></li><li><a href="Fragment.html#getName">getName</a></li><li><a href="Fragment.html#getPosition">getPosition</a></li><li><a href="Fragment.html#getRotation">getRotation</a></li><li><a href="Fragment.html#getX">getX</a></li><li><a href="Fragment.html#getY">getY</a></li><li><a href="Fragment.html#ghost">ghost</a></li><li><a href="Fragment.html#moveByDistance">moveByDistance</a></li><li><a href="Fragment.html#moveToPixel">moveToPixel</a></li><li><a href="Fragment.html#rotateByAngle">rotateByAngle</a></li><li><a href="Fragment.html#rotateToAngle">rotateToAngle</a></li><li><a href="Fragment.html#scaleToValue">scaleToValue</a></li><li><a href="Fragment.html#translateRotation">translateRotation</a></li></ul></div></li><li><a href="Measurement.html">Measurement</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Measurement_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Measurement.html#color">color</a></li><li><a href="Measurement.html#id">id</a></li><li><a href="Measurement.html#measurement">measurement</a></li><li><a href="Measurement.html#p1">p1</a></li><li><a href="Measurement.html#p2">p2</a></li><li><a href="Measurement.html#stage">stage</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Measurement.html#clearPoints">clearPoints</a></li><li><a href="Measurement.html#drawMeasurement">drawMeasurement</a></li><li><a href="Measurement.html#getColor">getColor</a></li><li><a href="Measurement.html#getDistanceInCm">getDistanceInCm</a></li><li><a href="Measurement.html#getDistanceInPixel">getDistanceInPixel</a></li><li><a href="Measurement.html#getID">getID</a></li><li><a href="Measurement.html#getMeasurement">getMeasurement</a></li><li><a href="Measurement.html#getP1">getP1</a></li><li><a href="Measurement.html#getP2">getP2</a></li><li><a href="Measurement.html#setP1">setP1</a></li><li><a href="Measurement.html#setP2">setP2</a></li><li><a href="Measurement.html#setPoint">setPoint</a></li></ul></div></li><li><a href="Scaler.html">Scaler</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Scaler_sub"></div></li><li><a href="Selector.html">Selector</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Selector_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Selector.html#getBb">getBb</a></li><li><a href="Selector.html#setToDefault">setToDefault</a></li><li><a href="Selector.html#updateBb">updateBb</a></li></ul></div></li><li><a href="Sidebar.html">Sidebar</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Sidebar_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Sidebar.html#_addFragment">_addFragment</a></li><li><a href="Sidebar.html#addFragmentListButtons">addFragmentListButtons</a></li><li><a href="Sidebar.html#addMeasurement">addMeasurement</a></li><li><a href="Sidebar.html#clearMeasurements">clearMeasurements</a></li><li><a href="Sidebar.html#clearSelection">clearSelection</a></li><li><a href="Sidebar.html#deleteMeasurement">deleteMeasurement</a></li><li><a href="Sidebar.html#deselectFragment">deselectFragment</a></li><li><a href="Sidebar.html#highlightFragment">highlightFragment</a></li><li><a href="Sidebar.html#removeFragmentListButtons">removeFragmentListButtons</a></li><li><a href="Sidebar.html#selectFragment">selectFragment</a></li><li><a href="Sidebar.html#unhighlightFragment">unhighlightFragment</a></li><li><a href="Sidebar.html#updateDoButtons">updateDoButtons</a></li><li><a href="Sidebar.html#updateFragmentList">updateFragmentList</a></li><li><a href="Sidebar.html#updateMeasurements">updateMeasurements</a></li></ul></div></li><li><a href="Stage.html">Stage</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Stage_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="Stage.html#activeMeasurement">activeMeasurement</a></li><li><a href="Stage.html#background">background</a></li><li><a href="Stage.html#controller">controller</a></li><li><a href="Stage.html#fragmentLabel">fragmentLabel</a></li><li><a href="Stage.html#fragmentList">fragmentList</a></li><li><a href="Stage.html#grid">grid</a></li><li><a href="Stage.html#gridMode">gridMode</a></li><li><a href="Stage.html#lines">lines</a></li><li><a href="Stage.html#loadqueue">loadqueue</a></li><li><a href="Stage.html#mColor">mColor</a></li><li><a href="Stage.html#measurements">measurements</a></li><li><a href="Stage.html#measurementsContainer">measurementsContainer</a></li><li><a href="Stage.html#measureMode">measureMode</a></li><li><a href="Stage.html#scale">scale</a></li><li><a href="Stage.html#scaleMode">scaleMode</a></li><li><a href="Stage.html#selectedList">selectedList</a></li><li><a href="Stage.html#selector">selector</a></li><li><a href="Stage.html#stage">stage</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="Stage.html#clearMeasurements">clearMeasurements</a></li><li><a href="Stage.html#clearSelection">clearSelection</a></li><li><a href="Stage.html#deleteMeasurement">deleteMeasurement</a></li><li><a href="Stage.html#deleteSelectedFragments">deleteSelectedFragments</a></li><li><a href="Stage.html#deselectFragment">deselectFragment</a></li><li><a href="Stage.html#endMeasurement">endMeasurement</a></li><li><a href="Stage.html#exportCanvas">exportCanvas</a></li><li><a href="Stage.html#fitToScreen">fitToScreen</a></li><li><a href="Stage.html#flipTable">flipTable</a></li><li><a href="Stage.html#getCenter">getCenter</a></li><li><a href="Stage.html#getData">getData</a></li><li><a href="Stage.html#getFragment">getFragment</a></li><li><a href="Stage.html#getFragmentList">getFragmentList</a></li><li><a href="Stage.html#getFragmentsData">getFragmentsData</a></li><li><a href="Stage.html#getMBR">getMBR</a></li><li><a href="Stage.html#getMeasureColor">getMeasureColor</a></li><li><a href="Stage.html#getNewFragmentId">getNewFragmentId</a></li><li><a href="Stage.html#getNewMeasurementID">getNewMeasurementID</a></li><li><a href="Stage.html#getRandomColor">getRandomColor</a></li><li><a href="Stage.html#getScaling">getScaling</a></li><li><a href="Stage.html#getSelectedList">getSelectedList</a></li><li><a href="Stage.html#getStageData">getStageData</a></li><li><a href="Stage.html#hasMeasureMode">hasMeasureMode</a></li><li><a href="Stage.html#hideFlipLines">hideFlipLines</a></li><li><a href="Stage.html#highlightFragment">highlightFragment</a></li><li><a href="Stage.html#loadScene">loadScene</a></li><li><a href="Stage.html#measure">measure</a></li><li><a href="Stage.html#moveStage">moveStage</a></li><li><a href="Stage.html#registerImageEvents">registerImageEvents</a></li><li><a href="Stage.html#removeFragment">removeFragment</a></li><li><a href="Stage.html#resizeCanvas">resizeCanvas</a></li><li><a href="Stage.html#selectFragment">selectFragment</a></li><li><a href="Stage.html#setScaling">setScaling</a></li><li><a href="Stage.html#showFlipLine">showFlipLine</a></li><li><a href="Stage.html#startMeasurement">startMeasurement</a></li><li><a href="Stage.html#toggleGridMode">toggleGridMode</a></li><li><a href="Stage.html#toggleScaleMode">toggleScaleMode</a></li><li><a href="Stage.html#unhighlightFragment">unhighlightFragment</a></li><li><a href="Stage.html#update">update</a></li><li><a href="Stage.html#updateGrid">updateGrid</a></li><li><a href="Stage.html#updateMeasurements">updateMeasurements</a></li><li><a href="Stage.html#updateScale">updateScale</a></li></ul></div></li><li><a href="UIController.html">UIController</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="UIController_sub"><div class="member-type">Members</div><ul class="inner"><li><a href="UIController.html#annotationPopup">annotationPopup</a></li><li><a href="UIController.html#darkBackground">darkBackground</a></li><li><a href="UIController.html#hasUnsaved">hasUnsaved</a></li><li><a href="UIController.html#hotkeysOn">hotkeysOn</a></li><li><a href="UIController.html#initiallySaved">initiallySaved</a></li><li><a href="UIController.html#lightMode">lightMode</a></li><li><a href="UIController.html#sidebar">sidebar</a></li><li><a href="UIController.html#stage">stage</a></li></ul><div class="member-type">Methods</div><ul class="inner"><li><a href="UIController.html#addFragment">addFragment</a></li><li><a href="UIController.html#addMeasurement">addMeasurement</a></li><li><a href="UIController.html#centerToFragment">centerToFragment</a></li><li><a href="UIController.html#changeFragment">changeFragment</a></li><li><a href="UIController.html#clearMeasurements">clearMeasurements</a></li><li><a href="UIController.html#clearSelection">clearSelection</a></li><li><a href="UIController.html#clearTable">clearTable</a></li><li><a href="UIController.html#confirmClearTable">confirmClearTable</a></li><li><a href="UIController.html#deleteAnnotation">deleteAnnotation</a></li><li><a href="UIController.html#deleteMeasurement">deleteMeasurement</a></li><li><a href="UIController.html#deselectFragment">deselectFragment</a></li><li><a href="UIController.html#disableHotkeys">disableHotkeys</a></li><li><a href="UIController.html#enableHotkeys">enableHotkeys</a></li><li><a href="UIController.html#endMeasurement">endMeasurement</a></li><li><a href="UIController.html#exportCanvas">exportCanvas</a></li><li><a href="UIController.html#fitToScreen">fitToScreen</a></li><li><a href="UIController.html#flipTable">flipTable</a></li><li><a href="UIController.html#getCanvasCenter">getCanvasCenter</a></li><li><a href="UIController.html#getHotkeysOn">getHotkeysOn</a></li><li><a href="UIController.html#getScaling">getScaling</a></li><li><a href="UIController.html#getSidebar">getSidebar</a></li><li><a href="UIController.html#getStage">getStage</a></li><li><a href="UIController.html#hideFlipLines">hideFlipLines</a></li><li><a href="UIController.html#highlightFragment">highlightFragment</a></li><li><a href="UIController.html#isDevMode">isDevMode</a></li><li><a href="UIController.html#loadScene">loadScene</a></li><li><a href="UIController.html#loadTable">loadTable</a></li><li><a href="UIController.html#previewBackground">previewBackground</a></li><li><a href="UIController.html#quitTable">quitTable</a></li><li><a href="UIController.html#redoMeasurement">redoMeasurement</a></li><li><a href="UIController.html#removeFragment">removeFragment</a></li><li><a href="UIController.html#removeFragments">removeFragments</a></li><li><a href="UIController.html#resetZoom">resetZoom</a></li><li><a href="UIController.html#resizeCanvas">resizeCanvas</a></li><li><a href="UIController.html#save">save</a></li><li><a href="UIController.html#saveToModel">saveToModel</a></li><li><a href="UIController.html#selectFragment">selectFragment</a></li><li><a href="UIController.html#sendAnnotation">sendAnnotation</a></li><li><a href="UIController.html#sendToServer">sendToServer</a></li><li><a href="UIController.html#setScaling">setScaling</a></li><li><a href="UIController.html#showFlipLine">showFlipLine</a></li><li><a href="UIController.html#showVisualFeedback">showVisualFeedback</a></li><li><a href="UIController.html#toggleAnnotSubmitButton">toggleAnnotSubmitButton</a></li><li><a href="UIController.html#toggleDevMode">toggleDevMode</a></li><li><a href="UIController.html#toggleGridMode">toggleGridMode</a></li><li><a href="UIController.html#toggleLight">toggleLight</a></li><li><a href="UIController.html#toggleScaleMode">toggleScaleMode</a></li><li><a href="UIController.html#unhighlightFragment">unhighlightFragment</a></li><li><a href="UIController.html#update">update</a></li><li><a href="UIController.html#updateAnnotation">updateAnnotation</a></li><li><a href="UIController.html#updateMeasurements">updateMeasurements</a></li><li><a href="UIController.html#updateSidebarFragmentList">updateSidebarFragmentList</a></li></ul></div></li><li><a href="Util.html">Util</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Util_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Util.html#.convertTime">convertTime</a></li></ul></div></li></ul></div><div class="lnb-api hidden"><h3>Global</h3><ul><li><a href="global.html#activateCanvas">activateCanvas</a></li><li><a href="global.html#activateKonami">activateKonami</a></li><li><a href="global.html#addPolygonNode">addPolygonNode</a></li><li><a href="global.html#addScalePoint">addScalePoint</a></li><li><a href="global.html#adjustSizes">adjustSizes</a></li><li><a href="global.html#checkForKonami">checkForKonami</a></li><li><a href="global.html#checkIfReady">checkIfReady</a></li><li><a href="global.html#clearCanvas">clearCanvas</a></li><li><a href="global.html#clearPolygon">clearPolygon</a></li><li><a href="global.html#clearSearch">clearSearch</a></li><li><a href="global.html#convertTime">convertTime</a></li><li><a href="global.html#cropSize">cropSize</a></li><li><a href="global.html#deactivateCanvas">deactivateCanvas</a></li><li><a href="global.html#deleteSavefile">deleteSavefile</a></li><li><a href="global.html#draw">draw</a></li><li><a href="global.html#drawCanvas">drawCanvas</a></li><li><a href="global.html#drawCropBox">drawCropBox</a></li><li><a href="global.html#drawMasks">drawMasks</a></li><li><a href="global.html#drawPolygon">drawPolygon</a></li><li><a href="global.html#drawScale">drawScale</a></li><li><a href="global.html#getFittingScale">getFittingScale</a></li><li><a href="global.html#handleScaleButton">handleScaleButton</a></li><li><a href="global.html#mirrorPolygon">mirrorPolygon</a></li><li><a href="global.html#moveImage">moveImage</a></li><li><a href="global.html#readExifPPI">readExifPPI</a></li><li><a href="global.html#resetCropbox">resetCropbox</a></li><li><a href="global.html#rotateImage">rotateImage</a></li><li><a href="global.html#selectDefaultFolder">selectDefaultFolder</a></li><li><a href="global.html#toggleSidebar">toggleSidebar</a></li><li><a href="global.html#updateModeButtons">updateModeButtons</a></li><li><a href="global.html#updateSaveList">updateSaveList</a></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>'use strict';

const {ipcRenderer} = require('electron');
const {Util} = require('./classes/Util');

let saves;
let currentSave;
const defaultFolder = './saves/';

/**
 * TODO
 */
function selectDefaultFolder() {
  $('#folder').val(defaultFolder);
  ipcRenderer.send('server-list-savefiles', defaultFolder);
}

$(document).ready(function() {
  selectDefaultFolder();
});

/**
 * TODO
 * @param {*} milliseconds
 * @return {*}
 */
function convertTime(milliseconds) {
  const time = new Date(milliseconds);

  const year = time.getFullYear();
  const month = ((time.getMonth()+1) &lt; 10 ? '0' : '') + (time.getMonth()+1);
  const day = (time.getDate() &lt; 10 ? '0' : '') + time.getDate();

  const hour = time.getHours();
  const minute = (time.getMinutes() &lt; 10 ? '0' : '') + time.getMinutes();
  const second = (time.getSeconds() &lt; 10 ? '0' : '') + time.getSeconds();

  return day+'.'+month+'.'+year+', '+hour+':'+minute+':'+second;
}

/**
 * TODO
 */
function deleteSavefile() {
  if ($('.selected').length > 0) {
    // 1. um welches Savefile geht es?
    const filename = $('.selected').attr('id');
    // 2. Bestätigungsdialog
    const confirmation = confirm('Do you really want to delete '+
            'this savefile? This action is irreversible.');
      // 3. Nachricht an Server: Save löschen
    if (confirmation) {
      ipcRenderer.send('server-delete-file', filename);
      // 3.1. aktuellen Detaileintrag löschen
      $('#thumb_reconstruction').css('display', 'none');
      $('#load_details').css('display', 'none');
      $('#thumb_list').empty();
    }
    // [4. Nachricht von Server mit aktuellem Speicherzustand]
  }
}

/**
 * TODO
 */
function clearSearch() {
  $('#fragment_search').val('');
}


/**
 * TODO
 * @param {*} searchString
 */
function updateSaveList(searchString) {
  $('#save_list_body').empty();
  $('#load').addClass('disabled');
  $('#delete').addClass('disabled');

  let nrHidden = 0;

  for (const [key, value] of Object.entries(saves)) {
    let valid = false;
    for (const id in saves[key].fragments) {
      if (saves[key].fragments[id].name.includes(searchString)) {
        valid = true;
      }
    }

    if (!searchString || valid) {
      let lastEditor = '';
      let numberFragments = '';
      if ('editors' in saves[key]) {
        lastEditor = saves[key].editors.slice(-1)[0];
      }
      if ('fragments' in saves[key]) {
        numberFragments = Object.keys(saves[key].fragments).length;
      }

      let tableRow = '&lt;tr class="save_list_item';
      if (key == currentSave) {
        tableRow += ' selected';
        $('#load').removeClass('disabled');
        $('#delete').removeClass('disabled');
      }
      tableRow += '" id="'+key+'">';
      tableRow += '&lt;td class="td_filename">'+key+'&lt;/td>';
      tableRow += '&lt;td class="td_fragments">'+numberFragments+'&lt;/td>';
      tableRow += '&lt;td class="td_mtime">'+
        Util.convertTime(saves[key].mtime)+'&lt;/td>';
      tableRow += '&lt;td class="td_editor">'+lastEditor[0]+'&lt;/tr>';

      $('#save_list_body').append(tableRow);
    } else {
      nrHidden += 1;
    }
  }
  if (nrHidden > 0) {
    $('#clear_filter').css('display', 'block');
    $('#clear_filter').html('Clear Filter&lt;/br>('+nrHidden+' files hidden)');
  } else {
    $('#clear_filter').css('display', 'none');
  }
}


/* ##########################################
#               INPUT/OUTPUT
########################################## */

$('#default_folder').click(selectDefaultFolder);

$('#select_folder').click(function() {
  ipcRenderer.send('server-get-saves-folder');
});

$('#fragment_search').on('input', function() {
  updateSaveList($('#fragment_search').val());
});

$('#clear_filter').click(function() {
  clearSearch();
  updateSaveList();
});

$('#save_list').on('dblclick', '.save_list_item', function(event) {
  currentSave = $(event.target).parent().attr('id');
  $(event.target).parent().addClass('selected');
  ipcRenderer.send('server-load-file', (saves[$('.selected').attr('id')]));
});

$('#save_list').on('click', '.save_list_item', function(event) {
  currentSave = $(event.target).parent().attr('id');
  $('.save_list_item').removeClass('selected');
  $(event.target).parent().addClass('selected');
  $('#load').removeClass('disabled');
  $('#delete').removeClass('disabled');
  $('#thumb_reconstruction').css('display', 'inline-block');
  $('#thumb_reconstruction').empty();

  const thumbnail = document.createElement('img');
  thumbnail.src = saves[currentSave].screenshot;
  document.getElementById('thumb_reconstruction').appendChild(thumbnail);

  $('#load_details').css('display', 'inline-block');

  const fragments = saves[currentSave].fragments;

  // Create the load_details_section
  const editors = saves[currentSave].editors;
  if (editors) {
    editors.sort(function(a, b) {
      return a[1] - b[1];
    });
  }
  const annots = saves[currentSave].annots;
  let annotItems;
  if (annots) {
    annotItems = Object.keys(annots).map(function(key) {
      return [key, annots[key]];
    });
    annotItems.sort(function(a, b) {
      return a.time - b.time;
    });
  }

  const table = document.createElement('table');

  // create filename row
  const filenameBody = document.createElement('tbody');
  filenameBody.setAttribute('id', 'details_filename');
  const filenameRow = document.createElement('tr');
  const filenameTd1 = document.createElement('td');
  filenameTd1.setAttribute('class', 'label');
  const filenameTd2 = document.createElement('td');
  filenameTd2.setAttribute('class', 'content');
  filenameTd1.appendChild(document.createTextNode('Filename:'));
  filenameTd2.appendChild(document.createTextNode(currentSave));
  filenameRow.appendChild(filenameTd1);
  filenameRow.appendChild(filenameTd2);
  filenameBody.append(filenameRow);
  table.appendChild(filenameBody);


  // create editor rows:
  let firstEditor = true;
  const editorBody = document.createElement('tbody');
  editorBody.setAttribute('id', 'details_editors');
  for (const idx in editors) {
    if (Object.prototype.hasOwnProperty.call(editors, idx)) {
      const editor = editors[idx][0];
      const time = Util.convertTime(editors[idx][1]);
      const editorRow = document.createElement('tr');
      const editorTd1 = document.createElement('td');
      editorTd1.setAttribute('class', 'label');
      const editorTd2 = document.createElement('td');
      editorTd2.setAttribute('class', 'content');
      if (firstEditor) {
        firstEditor = false;
        editorRow.setAttribute('class', 'first_row');
        editorTd1.appendChild(document.createTextNode('Last Editors:'));
      }
      editorTd2.appendChild(document.createTextNode('\u2022 ' +
            editor + ' (' + time + ')'));
      editorRow.appendChild(editorTd1);
      editorRow.appendChild(editorTd2);
      editorBody.appendChild(editorRow);
    }
  }
  table.appendChild(editorBody);

  // create annotation rows:
  let firstAnnot = true;
  const annotBody = document.createElement('tbody');
  annotBody.setAttribute('id', 'details_annots');
  for (const idx in annotItems) {
    if (Object.prototype.hasOwnProperty.call(annotItems, idx)) {
      const annotId = annotItems[idx][0];
      const annot = annots[annotId].text;
      const editor = annots[annotId].editor;
      const time = Util.convertTime(annots[annotId].time);
      const annotRow = document.createElement('tr');
      const annotTd1 = document.createElement('td');
      annotTd1.setAttribute('class', 'label');
      const annotTd2 = document.createElement('td');
      annotTd2.setAttribute('class', 'content');
      if (firstAnnot) {
        firstAnnot = false;
        annotRow.setAttribute('class', 'first_row');
        annotTd1.appendChild(document.createTextNode('Annotations:'));
      }
      annotTd2.appendChild(document.createTextNode('\u2022 ' +
            annot + ' (' + editor + ', ' + time + ')'));
      annotRow.appendChild(annotTd1);
      annotRow.appendChild(annotTd2);
      annotBody.appendChild(annotRow);
    }
  }
  table.appendChild(annotBody);


  $('#load_details').empty().append(table);

  $('#thumb_list').empty();

  try {
    for (const [key, value] of Object.entries(fragments)) {
      let url; let rt;
      if (fragments[key].recto ? url = fragments[key].rectoURL :
        url = fragments[key].versoURL);
      if (fragments[key].recto ? rt = 'rt' : rt = 'vs');
      let newTile = '&lt;div class="load_thumb" data-name="'+
        fragments[key].name+'">';
      newTile += '&lt;img class="load_thumb_img" src="'+url+'">';
      newTile += '&lt;span class="load_thumb_text">'+
        fragments[key].name+' ('+rt+')&lt;/span>';
      newTile += '&lt;/div>';
      $('#thumb_list').append(newTile);
      $('.load_thumb').click(function(event) {
        const name = $(this).data('name');
        $('#fragment_search').val(name);
        updateSaveList(name);
      });
    }
  } catch (err) {
    console.log(err);
    $('#thumb_reconstruction').css('display', 'none');
    $('#load_details').css('display', 'none');
    $('#thumb_list').append('&lt;div class="error_message">'+
        'Save file broken!&lt;/div>');
    $('#load').prop('disabled', true);
  }
});

$('#load').click(function() {
  if (!$('#load').hasClass('disabled')) {
    ipcRenderer.send('server-load-file', (saves[$('.selected').attr('id')]));
  }
});

$('#delete').click(function(event) {
  if (!$(event.target).hasClass('disabled')) {
    deleteSavefile();
  }
});

$('html').keyup(function(event) {
  if (event.keyCode == 46) {
    deleteSavefile();
  }
});

/* ##########################################
#           SERVER/CLIENT PROTOCOL
###########################################*/

// load-receive-saves
ipcRenderer.on('load-receive-saves', (event, savefiles) => {
  saves = savefiles;
  clearSearch();
  updateSaveList();
});

// load-receive-folder
ipcRenderer.on('load-receive-folder', (event, path) => {
  $('#folder').val(path);
  ipcRenderer.send('server-list-savefiles', path);
});
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="img/toast-ui.png" style="">
    <div class="footer-text">NHN Entertainment. Frontend Development Lab</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
