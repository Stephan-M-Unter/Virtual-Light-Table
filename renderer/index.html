<!DOCTYPE html>
<html lang="en">

<head>
    <title>Virtual Light Table v0.5 | Crossing Boundaries</title>
    <link rel="stylesheet" type="text/css" href="../js/libs/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="./index.css" />
    <script src="../js/libs/jquery-3.6.0.min.js"></script>
    <script>
        window.$ = window.jQuery = require('../js/libs/jquery-3.6.0.min.js');
    </script>
</head>

<body>
    <!-- Canvas -->
    <canvas id="lighttable"></canvas>

        <!-- Topbar-->
        <div id="topbar" class="no-select glass_pane">
            <div id="topbar_header" class="no-select">Active Tables</div>
            <div id="table_wrapper">
                <div id="table_list">
                    <div id="table_separator"></div>
                </div>
                <div title="Create new table" id="add_table">
                    <img src="../imgs/symbol_plus_zoom.png">
                </div>
            </div>
            <div id="topbar_handle" title="Toggle table bar">
                <div id="topbar_handle_arrow">
                    <img src="../imgs/symbol_arrow_down_swung.png">
                </div>
            </div>
        </div>
    
        <div id="rulers" class="hidden">
            <canvas id="ruler-left"></canvas>
            <canvas id="ruler-bottom"></canvas>
        </div>

    <!-- Zoom Elements -->
    <div id="zoom_wrapper" class="no-select">
        <input class="" id="zoom_slider" type="range" min="10" max="300" value="100" step="10" onkeydown="return false" />
        <span id="zoom_factor">x1.0</span>
    </div>
    <!-- </zoom_wrapper> -->

    <div title="Fit content to screen" id="fit_to_screen" class="squareButton no-select">
        <img src="../imgs/symbol_fit.png" />
    </div>

    <div title="Reset View to Table Origin" id="center_to_origin" class="squareButton no-select">
        <img src="../imgs/symbol_to_origin.png">
    </div>

    <div title="Hide GUI elements" id="hide_hud" class="squareButton no-select">
        <img src="../imgs/symbol_eye.png" />
    </div>

    <div title="Reset zoom to 1x" id="reset_zoom" class="squareButton no-select">
        <img src="../imgs/symbol_reset_zoom.png" />
    </div>

    <div id="annot_window">
        <div id="annot_title" class="no-select">Annotations</div>
        <div id="annot_show" class="no-select">Show Hidden</div>
        <div id="annot_close" class="no-select">
            <img class="no-select" src="../imgs/symbol_x.png" />
        </div>
        <div id="annot_view">
            <div id="annot_list"></div>
            <div id="annot_new" class="button no-select">
                <img src="../imgs/symbol_plus_zoom.png">
                <div>New Annotation</div>
            </div>
        </div>
        <div id="annot_write" class="hidden">
            <div id="annot_editor_label" class="no-select">Editor(s):</div>
            <input id="annot_editor" type="text"></input>
            <div id="annot_remove_pin" class="no-select hidden">
                <img src="../imgs/symbol_no_pin.png">
            </div>
            <div id="annot_set_pin" class="no-select">
                <img src="../imgs/symbol_pin_black.png">
                <div class="">Set Pin</div>
            </div>
            <div id="annot_text_label" class="no-select">Annotation:</div>
            <textarea id="annot_text" type="text"></textarea>
            <div class="wrapper-vertical wrapper-centered">
                <div class="button" id="annot_cancel">Cancel</div>
                <div class="button disabled" id="annot_submit">Write Annotation</div>
            </div>
        </div>
        <div id="annot_resize"></div>
    </div>

    <div title="Make annotations" id="annot_button">
        <div id="annot_button_img_wrapper">
            <img src="../imgs/symbol_annot.png" />
        </div>
    </div>

    <div id="overlay" class="hidden">
        <div id="overlay-central">
            <img id="loading-gif" src="../imgs/loading-large.gif">
            <div id="progress-wrapper" class="hidden">
                <progress id="progress" value="3" max="30"></progress>
            </div>
            <div id="progress-status" class="hidden">
                <span id="progress-pct"></span>% (<span id="progress-processed"></span>/<span id="progress-total"></span>)
            </div>
            <div id="progress-name" class="hidden"></div>
        </div>
    </div>

    <!-- Visual Feedback Popup -->
    <div id="visual_feedback">
        <div id="vf_title"></div>
        <div id="vf_desc"></div>
    </div>



    <!-- Left Sidebar -->
    <div id="left_sidebar" class="no-select small glass_pane">
        <div id="sidebar_content">
            <div class="sidebar_content_wrapper expanded" id="control">
                <div class="sidebar_header">
                    <div class="sidebar_header_title">Control Panel</div>
                    <img class="sidebar_header_help" src="../imgs/help.png" target="help-new-fragments">
                    <div class="arrow down"></div>
                </div>
                <div class="sidebar_content" id="control_content">

                    <!--
                        <div id="new_table" class="button wide_button no_select">
                            <img class="button_img" src="../imgs/symbol_new_table.png" />
                            <div class="button_label"><u>N</u>ew Table</div>
                        </div>
                    -->

                    <div class="sidebar_header_title">Table Commands</div>
                    <div title="Remove all elements from active table" id="clear_table" class="button wide_button no_select">
                        <img class="button_img" src="../imgs/symbol_new_table.png" />
                        <div class="button_label"><span class="underline_double">C</span>lear</div>
                    </div>

                    <div  title="Save to existing file" id="save_quick" class="button wide_button no_select">
                        <img class="button_img" src="../imgs/symbol_save.png" />
                        <div class="button_label">(Quick-)<span class="underline_double">S</span>ave</div>
                    </div>                    
                    <div title="Save as new file" id="save_as" class="button wide_button no_select">
                        <img class="button_img" src="../imgs/symbol_save.png" />
                        <div class="button_label"><span class="underline_dotted">S</span>ave As...</div>
                    </div>

                    <div title="Open new window to load existing file" id="load_table" class="button wide_button no_select">
                        <img class="button_img" src="../imgs/symbol_load.png" />
                        <div class="button_label"><span class="underline_double">L</span>oad</div>
                    </div>

                    <div title="Download reconstruction as image file" id="export_table" class="button wide_button no_select">
                        <img class="button_img" src="../imgs/symbol_export.png" />
                        <div class="button_label">Export</div>
                    </div>

                    <div id="export_detail_wrapper">
                        <div class="sidebar_header_title">Section / Complete</div>
                        <div id="jpg_wrapper">
                            <div title="Download JPG, current view" id="jpg_snap" class="button narrow_button no_select">
                                <img class="button_img" src="../imgs/symbol_jpg_snap.png" />
                            </div>
                            <div title="Download JPG, full table" id="jpg_full" class="button narrow_button no_select">
                                <img class="button_img" src="../imgs/symbol_jpg_full.png" />
                            </div>
                        </div>
                        <div id="color_wrapper">
                            <div class="sidebar_header_title">Background Color</div>
                            <div title="White background" class="color_button white selected"></div>
                            <div title="Grey background" class="color_button grey"></div>
                            <div title="Darkblue background" class="color_button darkblue"></div>
                            <div title="Black background" class="color_button black"></div>
                        </div>
                        <div id="png_wrapper">
                            <div title="Download PNG, current view" id="png_snap" class="button narrow_button no_select">
                                <img class="button_img" src="../imgs/symbol_png_snap.png" />
                            </div>
                            <div title="Download PNG, full table" id="png_full" class="button narrow_button no_select">
                                <img class="button_img" src="../imgs/symbol_png_full.png" />
                            </div>
                        </div>
                        <div id="tiff_wrapper">
                            <div title="Download TIFF, current view" id="tiff_snap" class="button narrow_button no_select">
                                <img class="button_img" src="../imgs/symbol_tif_snap.png" />
                            </div>
                            <div title="Download TIFF, full table" id="tiff_full" class="button narrow_button no_select">
                                <img class="button_img" src="../imgs/symbol_tif_full.png" />
                            </div>
                        </div>
                    </div>

                    <div title="VLT Settings" id="settings" class="button wide_button no_select">
                        <img class="button_img" src="../imgs/symbol_gear.png" />
                        <div class="button_label">Settings</div>
                    </div>

                    <div title="Quit Virtual Light Table" id="quit" class="button wide_button no_select">
                        <img class="button_img" src="../imgs/symbol_x.png" />
                        <div class="button_label">Quit</div>
                    </div>

                    <hr>

                    <div class="sidebar_header_title">Undo/Redo</div>
                    <div id="stepWrapper">
                        <div title="Undo last step" id="undo" class="button narrow_button no_select disabled">
                            <img class="button_img" src="../imgs/symbol_undo.png" />
                            <div class="button_number"></div>
                            <div class="button_label">Undo</div>
                        </div>
                        <div title="Redo last step" id="redo" class="button narrow_button no_select disabled">
                            <img class="button_img" src="../imgs/symbol_redo.png" />
                            <div class="button_number"></div>
                            <div class="button_label">Redo</div>
                        </div>
                    </div>

                    <hr>

                    <div class="sidebar_header_title">Tools</div>
                    <div class="wrapper_tool" id="wrapper_workarea">
                        <div class="sidebar_header_subtitle">Reconstruction Area</div>
                        <div class="" id="wrapper_workarea_sizes">
                            <div class="wrapper_workarea_size">
                                <input type="number" min="0" class="workarea_size" id="workarea-width" placeholder="e.g. 32.5">
                                <label>cm (W)</label>
                            </div>
                            <div class="wrapper_workarea_size">
                                <input type="number" min="0" class="workarea_size" id="workarea-height" placeholder="e.g. 42">
                                <label>cm (H)</label>
                            </div>
                        </div>
                        <div class="hidden" id="workarea_clear">Remove Area</div>
                    </div>
                    <div class="wrapper_tool" id="wrapper_measure">
                        <div><span class="underline sidebar_header_subtitle">M</span>easurement</div>
                        <div title="Add new measurement" class="button narrow_button no_select" id="new_measure">
                            <img class="button_img" src="../imgs/symbol_new_measure.png"/>
                        </div>
                        <div id="clear-measures" class="no_select hidden">Remove All</div>
                    </div>

                    <hr>

                    <div class="sidebar_header_title">Display</div>
                    <div id="display-wrapper">
                        <div class="display-item-wrapper button" id="light-wrapper">
                            <img src="../imgs/symbol_light.png">
                            <div class="display-item-label"><span class="underline">L</span>ight</div>
                        </div>
                        <div class="display-item-wrapper button" id="grid-wrapper">
                            <img src="../imgs/symbol_grid.png">
                            <div class="display-item-label"><span class="underline">G</span>rid</div>
                        </div>
                        <div class="display-item-wrapper button" id="scale-wrapper">
                            <img src="../imgs/symbol_scale.png">
                            <div class="display-item-label"><span class="underline">S</span>cale</div>
                        </div>
                        <div class="display-item-wrapper button" id="ruler-wrapper">
                            <img src="../imgs/symbol_ruler.png">
                            <div class="display-item-label"><span class="underline">R</span>ulers</div>
                        </div>
                        <div class="display-item-wrapper button" id="flip-vert-wrapper">
                            <img src="../imgs/symbol_vertical_flip.svg">
                            <div class="display-item-label">Flip Table (vert)</div>
                        </div>
                        <div class="display-item-wrapper button" id="flip-hor-wrapper">
                            <img src="../imgs/symbol_horizontal_flip.svg">
                            <div class="display-item-label">Flip Table (hor)</div>
                        </div>
                    </div>
                    
                    
                    <!--
                        <div class="display-item-wrapper button" id="fibre-wrapper">
                            <img src="../imgs/symbol_light.png">
                            <div class="display-item-label">Fibres</div>
                        </div>
                    -->

                </div>
            </div>

            <div class="sidebar_content_wrapper" id="graphical_filters">
                <div class="sidebar_header">
                    <div class="sidebar_header_title">Graphical Filters</div>
                    <img class="sidebar_header_help" src="../imgs/help.png" target="help-graphical-filters">
                    <div class="arrow"></div>
                </div>
                <div class="sidebar_content" id="graphical_filters_content">
                    <div class="graphics-filter">
                        <div title="Reset images" id="graphics-reset" class="button wide_button no_select">
                            <img class="button_img" src="../imgs/symbol_reset.png" />
                            <div class="button_label">Reset</div>
                        </div>
                    </div>
                    <div class="graphics-filter">
                        <label class="sidebar_header_title">Brightness</label>
                        <input type="range" min="0" max="2" value="1" step="0.1" id="graphics-brightness"/>
                    </div>
                    <div class="graphics-filter">
                        <label class="sidebar_header_title">Contrast</label>
                        <input type="range" min="-4" max="5" value="1" step="0.1" id="graphics-contrast"/>
                    </div>
                    <div class="graphics-filter">
                        <label class="sidebar_header_title">Colour Inversion</label>
                        <div class="flip-buttons">
                            <div class="flip-button R" data="R">R</div>
                            <div class="flip-button G" data="G">G</div>
                            <div class="flip-button B" data="B">B</div>
                        </div>
                    </div>
                    <div class="graphics-filter">
                        Under construction.
                    </div>
                </div>
            </div>
            <!-- </graphical filters> -->
            <div class="sidebar_content_wrapper" id="fragment_list">
                <div class="sidebar_header">
                    <div class="sidebar_header_title">Fragments</div>
                    <img class="sidebar_header_help" src="../imgs/help.png" target="help-fragment-list">
                    <div class="arrow"></div>
                </div>
                <div title="Upload custom fragments from your local drive" id="upload_local" class="button wide_button">
                    <img class="button_img" src="../imgs/symbol_upload_local.png" />
                    <div class="button_label">Upload Fragment</div>
                </div>
                <div title="Browse and select fragments from the TPOP collection" id="upload_tpop" class="button wide_button tpop">
                    <img class="button_img" src="../imgs/symbol_tpop.png" />
                    <div class="button_label">TPOP Fragments</div>
                </div>
                <hr>
                <div class="sidebar_content" id="fragment_list_content">
                    <div id="fragment_list_nocontent">No fragments selected</div>
                </div>
            </div>
            <!-- </fragment_list> -->
        </div>
        <div id="sidebar_handle" title="Toggle sidebar">
            <div id="sidebar_handle_grabber">...</div>
        </div>

    </div>
    <!-- </left_sidebar> -->

    <div id="contextmenu" class="no-select">
        <div class="context-item">
            <div class="context-img-wrapper">
                <img class="context-img" src="../imgs/symbol_edit.png">
            </div>
            <div class="context-label">Edit Fragment</div>
        </div>
        <div class="context-item">
            <div class="context-img-wrapper">
                <img class="context-img" src="../imgs/symbol_x.png">
            </div>
            <div class="context-label">Remove Fragment</div>
        </div>
        <div class="context-item">
            <div class="context-img-wrapper">
                <img class="context-img" src="../imgs/symbol_unlocked.png">
            </div>
            <div class="context-label">Lock Fragment</div>
        </div>
        <div class="context-item">
            <div class="context-img-wrapper">
                <img class="context-img" src="../imgs/symbol_flip.png">
            </div>
            <div class="context-label">Flip Fragment</div>
        </div>
    </div>


    <script src="../js/libs/createjs.min.js"></script>
    <script src="../js/libs/preloadjs.min.js"></script>
    <script src="../js/libs/hammer.min.js"></script>
    <script src="../js/libs/canvastotiff.min.js"></script>
    <script src="./index.js"></script>
</body>

</html>